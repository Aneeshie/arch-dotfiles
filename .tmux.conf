# ~/.tmux.conf
# Tmux configuration with Catppuccin Macchiato theme and vim-like bindings

# ================================
# BASIC SETTINGS
# ================================

# Change prefix from Ctrl+b to Ctrl+c
unbind C-b
set-option -g prefix C-c
bind-key C-c send-prefix

# Start window and pane indexing at 1 instead of 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Enable mouse support
set -g mouse on

# Set default terminal mode to 256color
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Increase scrollback buffer size
set -g history-limit 10000

# Set escape time to 0 for vim compatibility
set -sg escape-time 0

# Enable activity alerts
setw -g monitor-activity on
set -g visual-activity on

# ================================
# VIM-LIKE KEYBINDINGS
# ================================

# Reload config file
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Split panes using | and - (more intuitive than % and ")
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Switch panes using vim-like hjkl keys
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes using vim-like keys
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Copy mode vim-like bindings
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle

# Enter copy mode
bind Escape copy-mode

# ================================
# WINDOW SWITCHING (Option + Number)
# ================================

# Smart window switching: create if doesn't exist, switch if it does
bind-key -n M-1 if-shell 'tmux list-windows | grep -q "^1:"' 'select-window -t 1' 'new-window -t 1'
bind-key -n M-2 if-shell 'tmux list-windows | grep -q "^2:"' 'select-window -t 2' 'new-window -t 2'
bind-key -n M-3 if-shell 'tmux list-windows | grep -q "^3:"' 'select-window -t 3' 'new-window -t 3'
bind-key -n M-4 if-shell 'tmux list-windows | grep -q "^4:"' 'select-window -t 4' 'new-window -t 4'
bind-key -n M-5 if-shell 'tmux list-windows | grep -q "^5:"' 'select-window -t 5' 'new-window -t 5'
bind-key -n M-6 if-shell 'tmux list-windows | grep -q "^6:"' 'select-window -t 6' 'new-window -t 6'
bind-key -n M-7 if-shell 'tmux list-windows | grep -q "^7:"' 'select-window -t 7' 'new-window -t 7'
bind-key -n M-8 if-shell 'tmux list-windows | grep -q "^8:"' 'select-window -t 8' 'new-window -t 8'
bind-key -n M-9 if-shell 'tmux list-windows | grep -q "^9:"' 'select-window -t 9' 'new-window -t 9'
bind-key -n M-0 if-shell 'tmux list-windows | grep -q "^10:"' 'select-window -t 10' 'new-window -t 10'

# Create new window
bind c new-window -c "#{pane_current_path}"

# ================================
# CATPPUCCIN MACCHIATO THEME
# ================================

# Catppuccin Macchiato color palette
thm_bg="#24273a"
thm_fg="#cad3f5"
thm_cyan="#91d7e3"
thm_black="#1e2030"
thm_gray="#363a4f"
thm_magenta="#c6a0f6"
thm_pink="#f5bde6"
thm_red="#ed8796"
thm_green="#a6da95"
thm_yellow="#eed49f"
thm_blue="#8aadf4"
thm_orange="#f5a97f"
thm_black4="#5b6078"

# Status bar configuration
set -g status on
set -g status-bg "${thm_bg}"
set -g status-fg "${thm_fg}"
set -g status-interval 1
set -g status-justify left

# Status bar length
set -g status-left-length 100
set -g status-right-length 100

# Pane border colors
set -g pane-border-style "fg=${thm_gray}"
set -g pane-active-border-style "fg=${thm_blue}"

# Window status format
setw -g window-status-format "#[fg=${thm_fg},bg=${thm_bg}] #I #W "
setw -g window-status-current-format "#[fg=${thm_bg},bg=${thm_blue}] #I #W #[fg=${thm_blue},bg=${thm_bg}]"

# Left status bar - Session name and window info
set -g status-left "#[fg=${thm_bg},bg=${thm_magenta},bold] #S #[fg=${thm_magenta},bg=${thm_bg}]"

# Right status bar - System info
set -g status-right "#[fg=${thm_black4}]#[fg=${thm_fg},bg=${thm_black4}] %Y-%m-%d #[fg=${thm_gray}]#[fg=${thm_fg},bg=${thm_gray}] %H:%M #[fg=${thm_green}]#[fg=${thm_bg},bg=${thm_green},bold] #h "

# Message styling
set -g message-style "fg=${thm_cyan},bg=${thm_gray}"
set -g message-command-style "fg=${thm_cyan},bg=${thm_gray}"

# Copy mode highlighting
setw -g mode-style "fg=${thm_pink},bg=${thm_black4}"

# Clock mode color
setw -g clock-mode-colour "${thm_blue}"

# ================================
# ADDITIONAL UI ENHANCEMENTS
# ================================

# Window activity notification
setw -g window-status-activity-style "fg=${thm_red},bg=${thm_bg}"

# Bell notification
set -g window-status-bell-style "fg=${thm_yellow},bg=${thm_bg},bold"

# Display tmux session name in terminal title
set -g set-titles on
set -g set-titles-string "#T"

# Automatically set window title
setw -g automatic-rename on

# ================================
# PLUGIN MANAGER (TPM) - OPTIONAL
# ================================

# List of plugins (uncomment if you want to use plugins)
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'

# Initialize TMUX plugin manager (keep this line at the very bottom)
# run '~/.tmux/plugins/tpm/tpm'

# ================================
# CUSTOM FUNCTIONS & ALIASES
# ================================

# Quick session switching
bind-key s choose-tree -sZ -O name

# Kill session
bind-key X confirm-before -p 'kill-session #S? (y/n)' kill-session

# Clear screen and history
bind -n C-l send-keys 'C-l' \; run 'sleep 0.1' \; clear-history

